# Системные настройки

Системные настройки — это место, где вы настраиваете фундаментальное поведение, которое влияет на каждого пользователя и запись в вашем экземпляре Speakr. Эти глобальные параметры формируют то, как система работает, от технических лимитов до функций, обращенных к пользователям.

![Системные настройки](../assets/images/screenshots/Admin system settings.png)

## Лимит длины транскрипта

Лимит длины транскрипта определяет, сколько текста отправляется в ИИ при генерации сводок или ответах в чатах. Это кажущееся простым число имеет большое влияние как на качество, так и на стоимость.

Когда установлено "No Limit", весь транскрипт отправляется в ИИ независимо от длины. Это обеспечивает, что ИИ имеет полный контекст, но может стать дорогим для длинных записей. Двухчасовая встреча может сгенерировать 20 000 слов транскрипта, потребляя значительные токены API и потенциально перегружая контекстное окно модели ИИ. Этот лимит также будет применен к функции автоматического обнаружения говорящих в модальном окне идентификации говорящих.

Установка лимита символов (например, 50 000 символов) создает потолок на потребление API. Система будет обрезать очень длинные транскрипты, отправляя только начальную часть в ИИ. Это сохраняет затраты предсказуемыми, но может означать, что ИИ пропустит важный контент из более поздней части записи.

Золотая середина зависит от вашего случая использования. Для типичных встреч менее часа 50 000 символов обычно захватывает все. Для более длинных сессий вы можете увеличить этот лимит или обучить пользователей разделять записи. Отслеживайте ваши затраты API и обратную связь пользователей, чтобы найти правильный баланс.

## Максимальный размер файла

Лимит размера файла защищает вашу систему от перегрузки массивными загрузками, обеспечивая при этом, что пользователи могут работать с разумными записями. По умолчанию 300 МБ вмещает несколько часов сжатого аудио, что покрывает большинство случаев использования.

Повышение этого лимита позволяет более длинные записи, но требует тщательного рассмотрения. Более крупные файлы занимают больше времени для загрузки, потребляют больше хранилища и могут таймаутиться во время обработки. Ваш сервер нуждается в достаточной памяти для обработки этих файлов, и ваше хранилище должно их вмещать. Сетевые таймауты, ограничения браузера и терпение пользователей — все это факторы в том, что практично.

Если пользователи часто достигают лимита, рассмотрите, действительно ли им нужны одиночные записи такой длины. Часто разделение длинных сессий на логические сегменты дает лучшие результаты — легче просматривать, быстрее обрабатывать и более сфокусированные сводки.

## Настройки таймаута ASR

Таймаут ASR определяет, как долго Speakr будет ждать, пока продвинутые сервисы транскрибации завершат свою работу. По умолчанию 1 800 секунд (30 минут) обрабатывает большинство записей, но вам может потребоваться настроить на основе вашего сервиса транскрибации и типичных размеров файлов.

Установка этого слишком низко вызывает сбой более длинных записей даже когда сервис транскрибации работает нормально. Запись кажется застрявшей в обработке, затем в конечном итоге терпит неудачу, расстраивая пользователей, которые должны повторить попытку или сдаться. Установка слишком высоко связывает системные ресурсы, ожидая сервисы, которые могли фактически потерпеть неудачу.

Ваш оптимальный таймаут зависит от производительности вашего сервиса транскрибации и длин записей ваших пользователей. Отслеживайте времена обработки для успешных транскрибаций и установите таймаут комфортно выше вашего самого длинного нормального времени обработки. Если вы регулярно обрабатываете многочасовые записи, вам может потребоваться 3 600 секунд или больше.

## Отказ от ответственности при записи

Отказ от ответственности при записи появляется перед тем, как пользователи начинают любую сессию записи, делая его идеальным для юридических уведомлений, напоминаний о политике или руководящих принципов использования. Это сообщение в формате markdown обеспечивает, что пользователи понимают свои обязанности перед созданием контента.

Организации часто используют это для требований соответствия — напоминая пользователям о требованиях согласия, политиках обработки данных или руководящих принципах соответствующего использования. Образовательные учреждения могут отметить, что записи только для академических целей. Организации здравоохранения могут ссылаться на требования соответствия HIPAA.

Держите отказы от ответственности краткими и релевантными. Пользователи видят это сообщение часто, поэтому длинный юридический текст становится игнорируемым проходом. Сосредоточьтесь на самых важных пунктах и ссылайтесь на подробные политики при необходимости. Поддержка markdown позволяет вам форматировать сообщение четко с жирным текстом для акцента или ссылками на дополнительные ресурсы.

## Системное влияние

Каждая настройка на этой странице влияет на всех пользователей немедленно. Изменения вступают в силу, как только вы их сохраняете, без необходимости перезапуска системы или выхода пользователей. Это немедленное применение означает, что вы должны тщательно тестировать изменения и сообщать о значительных модификациях вашим пользователям.

Кнопка обновления перезагружает настройки из базы данных, полезно, если несколько администраторов могут вносить изменения или если вы хотите убедиться, что видите последние значения. Интерфейс показывает, когда каждая настройка была последний раз обновлена, помогая вам отслеживать изменения со временем.

## Решение распространенных проблем

Когда записи терпят неудачу последовательно, проверьте, достигают ли они ваших настроенных лимитов. Логи ошибок укажут, слишком ли большие файлы или таймаутится ли обработка. Пользователи могут не осознавать, что их записи превышают лимиты, особенно если они загружают существующий контент, а не записывают напрямую.

Если затраты API неожиданно всплескивают, просмотрите ваш лимит длины транскрипта. Один пользователь, загружающий много длинных записей, может драматически увеличить потребление, если лимит не установлен. Комбинация активности пользователей и системных настроек определяет ваши фактические затраты.

Очереди обработки могут указывать, что ваш таймаут слишком высок. Если система ждет 30 минут для каждой неудачной попытки транскрибации, серия проблемных файлов может заблокировать очередь на часы. Балансируйте терпение для медленной обработки с необходимостью быстро терпеть неудачу, когда сервисы фактически не работают.

## Конфигурация переменных окружения

Помимо настроек, настраиваемых через UI выше, несколько переменных окружения в вашем файле `.env` контролируют фундаментальное системное поведение. Они требуют перезапуска экземпляра для вступления в силу.

### Сотрудничество и обмен

**ENABLE_INTERNAL_SHARING**: Контролирует возможности обмена пользователь-пользователь. Установите в `true`, чтобы включить функции внутреннего обмена, позволяя пользователям делиться записями с конкретными коллегами. Требуется для групповой функциональности. По умолчанию: `false`.

**SHOW_USERNAMES_IN_UI**: Контролирует видимость имен пользователей в интерфейсе. Когда `true`, имена пользователей отображаются по всему UI при обмене и сотрудничестве. Когда `false`, имена пользователей скрыты — пользователи должны знать имена пользователей друг друга для обмена записями (они вводят имя пользователя вручную). По умолчанию: `false`.

**ENABLE_PUBLIC_SHARING**: Контролирует, могут ли быть созданы публичные ссылки для обмена. Когда `true`, авторизованные пользователи могут генерировать безопасные ссылки для внешнего обмена. Когда `false`, доступен только внутренний обмен. По умолчанию: `false`.

### Разрешения пользователей

**USERS_CAN_DELETE**: Определяет, могут ли обычные пользователи удалять свои собственные записи. Когда `true`, пользователи видят кнопки удаления для своих записей. Когда `false`, только администраторы могут удалять записи. Это помогает предотвратить случайную потерю данных и поддерживает хранение контента для соответствия требованиям. По умолчанию: `true`.

### Хранение и автоматическое удаление

**ENABLE_AUTO_DELETION**: Включает автоматизированную систему хранения. Когда `true`, записи старше периода хранения автоматически обрабатываются для удаления. По умолчанию: `false`.

**DEFAULT_RETENTION_DAYS**: Глобальный период хранения в днях для записей без специфичного для тега хранения. Установите в `0`, чтобы отключить автоматическое удаление. Политики хранения на уровне тегов могут переопределить это по умолчанию. По умолчанию: `0` (отключено).

**DELETION_MODE**: Контролирует, что удаляется: `audio_only` удаляет аудиофайлы, но сохраняет транскрипции и метаданные, в то время как `full_recording` удаляет все. Режим только аудио поддерживает доступные для поиска записи, экономя пространство хранилища. По умолчанию: `audio_only`.

Для подробной конфигурации хранения см. руководство [Хранение и автоматическое удаление](retention.md).

### Пример конфигурации

```bash
# Включить функции сотрудничества
ENABLE_INTERNAL_SHARING=true
SHOW_USERNAMES_IN_UI=true
ENABLE_PUBLIC_SHARING=false

# Разрешения пользователей
USERS_CAN_DELETE=false  # Только администраторы могут удалять

# Политика хранения
ENABLE_AUTO_DELETION=true
DEFAULT_RETENTION_DAYS=90
DELETION_MODE=audio_only
```

После изменения переменных окружения перезапустите ваш экземпляр Speakr, чтобы изменения вступили в силу:
```bash
docker compose restart
```

---

Далее: [Промпты по умолчанию](prompts.md) →
