---
layout: default
title: Управление группами
parent: Руководство администратора
nav_order: 6
---

# Управление группами

Группы обеспечивают организованное сотрудничество в многопользовательских экземплярах Speakr, группируя пользователей и автоматизируя доступ к записям через теги, специфичные для группы. Эта мощная функция снижает административные накладные расходы, поддерживая безопасность и контроль над доступом к контенту.

## Предварительные требования

Перед включением групп убедитесь, что внутренний обмен настроен. Группы строятся на инфраструктуре внутреннего обмена Speakr для автоматического предоставления доступа, когда пользователи применяют групповые теги.

### Необходимая конфигурация

Добавьте эти настройки в ваш файл `.env`:

```bash
# Включить внутренний обмен (требуется для групп)
ENABLE_INTERNAL_SHARING=true

# Контроль видимости имени пользователя
SHOW_USERNAMES_IN_UI=true   # Показывать имена пользователей в UI
# ИЛИ
SHOW_USERNAMES_IN_UI=false  # Скрывать имена пользователей (пользователи вводят имена пользователей вручную для обмена)
```

После изменения `.env` перезапустите ваш экземпляр Speakr, чтобы изменения вступили в силу. Вкладка Groups появится в административной панели после включения внутреннего обмена.

### Соображения конфиденциальности

Настройка `SHOW_USERNAMES_IN_UI` влияет на весь экземпляр. Когда включено (`true`), пользователи видят фактические имена пользователей при поиске коллег и просмотре общего контента. Это улучшает удобство использования в небольших, доверенных группах, где все знают друг друга.

Когда отключено (`false`), имена пользователей скрыты из интерфейса. Пользователи должны знать имена пользователей друг друга для обмена записями — они вводят имя пользователя вручную при создании общих доступов. Этот подход, ориентированный на конфиденциальность, подходит организациям, где видимость имени пользователя должна быть ограничена. Групповая функциональность работает идентично в обоих режимах — изменяется только отображение.

## Создание и управление группами

Группы создаются и управляются исключительно через административную панель. Обычные пользователи не могут создавать группы, обеспечивая централизованный контроль над организационной структурой.

### Создание группы

Перейдите в Административную панель и выберите вкладку Groups. Нажмите "Create Group", чтобы открыть модальное окно создания. Укажите имя группы, которое четко идентифицирует цель группы — "Engineering", "Sales EMEA", "Project Phoenix" и т.д. Описательные имена помогают пользователям понимать область и цель каждой группы.

Поле описания необязательно, но рекомендуется. Используйте его для объяснения цели группы, какие проекты или отделы она обслуживает, или кто должен быть участником. Хорошие описания помогают будущим администраторам понимать организацию группы и принимать решения о членстве.

Нажмите "Create Group", чтобы завершить создание. Группа появляется в вашем списке групп немедленно, хотя она начинается без участников. Создающий пользователь (вы) не присоединяется автоматически — членство должно быть явно предоставлено даже для создателей группы.

### Управление членством в группе

Нажмите значок users-cog рядом с любой группой, чтобы открыть модальное окно управления группой. Этот интерфейс показывает текущих участников, их роли и предоставляет инструменты для добавления или удаления участников.

Чтобы добавить участника, выберите пользователя из выпадающего списка и выберите их роль:

- **Member**: Может использовать групповые теги и получать доступ к записям с групповыми тегами. Подходит для большинства участников группы, которым нужно сотрудничать над контентом.
- **Admin**: Все возможности участника плюс способность управлять членством в группе, создавать и удалять групповые теги и получать доступ к функциям управления группами. Полезно для лидеров групп или менеджеров, которым нужен административный контроль.

Нажмите "Add Member", чтобы предоставить доступ. Пользователь немедленно получает видимость групповых тегов и будет получать будущие записи с групповыми тегами. Они не получают автоматически доступ к существующим записям с групповыми тегами — только к новым, помеченным после того, как они присоединились.

### Изменение ролей участников

Роли в группе могут изменяться по мере эволюции обязанностей. Нажмите выпадающий список ролей рядом с любым участником, чтобы переключить их между Member и Admin. Изменения ролей вступают в силу немедленно.

Повышение участников до администратора предоставляет им доступ к возможностям управления группами. Они увидят ссылку "Group Management" в своем интерфейсе и могут добавлять/удалять участников, создавать теги и управлять группой независимо. Это распределяет административную рабочую нагрузку и расширяет возможности лидеров групп.

Понижение администраторов до участников удаляет их возможности управления, но сохраняет их членство в группе. Они сохраняют доступ к групповым тегам и записям, но больше не могут управлять членством в группе или тегами.

### Удаление участников группы

Нажмите красный значок user-times рядом с любым участником, чтобы удалить его из группы. Удаление немедленное и имеет несколько эффектов:

- Пользователь теряет доступ к групповым тегам
- Они не будут получать новые записи с групповыми тегами
- Их доступ к ранее общим групповым записям сохраняется
- Их личные заметки на групповых записях сохраняются

Если вам нужно полностью отозвать доступ к существующим групповым записям, вы должны вручную отозвать эти внутренние общие доступы через интерфейс управления обменом записи. Удаление из группы только предотвращает будущий автоматический обмен.

### Удаление групп

Нажмите красный значок корзины рядом с группой, чтобы удалить её полностью. Диалог подтверждения предотвращает случайное удаление. Удаление группы:

- Удаляет все членства в группе
- Удаляет все групповые теги (через каскад базы данных)
- Сохраняет все записи (включая ранее помеченные группой)
- Сохраняет все внутренние общие доступы, созданные групповыми тегами

Удаление группы необратимо. После удаления структура группы исчезает, хотя записи и разрешения доступа, созданные группой, сохраняются. Если вам нужно временно отключить группу, рассмотрите удаление всех участников вместо удаления самой группы.

## Групповые теги

Групповые теги обеспечивают автоматический обмен внутри групп. В отличие от личных тегов, которые организуют индивидуальный контент, групповые теги запускают предоставление доступа всем участникам группы всякий раз, когда применяются.

### Создание групповых тегов

Из вкладки Groups нажмите фиолетовый значок тегов рядом с соответствующей группой. Это открывает модальное окно групповых тегов, показывающее существующие теги и форму создания.

Укажите имя тега, которое описывает тип контента или цель. Хорошие имена специфичны и ясны: "Sprint Reviews", "Customer Calls", "Legal Contracts". Избегайте общих имен, таких как "Important" или "Group", которые не передают полезную информацию.

Выберите цвет для визуального различения тега. Цвета помогают пользователям быстро идентифицировать категории контента в интерфейсе. Рассмотрите установление цветовых соглашений — синий для технического контента, зеленый для продаж, красный для юридического и т.д.

### Политики хранения тегов

Групповые теги могут переопределять глобальные настройки хранения с периодами хранения, специфичными для тегов. Эта мощная функция позволяет разным типам контента иметь разные жизненные циклы в одном экземпляре.

Оставьте поле хранения пустым, чтобы использовать глобальные настройки хранения. Тег не будет влиять на то, как долго записи хранятся — они будут следовать настройке `GLOBAL_RETENTION_DAYS` для всего экземпляра.

Введите количество дней, чтобы установить пользовательское хранение для этого тега. Записи с этим тегом будут автоматически удаляться после указанного периода, независимо от глобальных настроек. Например:

- Юридическая группа: 2555 дней (7 лет) для контрактов и записей соответствия требованиям
- Операционная группа: 14 дней для ежедневных стендапов
- Маркетинговая группа: 180 дней для сессий планирования кампаний

Когда запись имеет несколько тегов с разными периодами хранения, применяется **самый короткий** период. Это обеспечивает, что контент никогда не хранится дольше, чем позволяет его самый ограничительный тег.

### Защита от удаления

Включите "Protect from deletion", чтобы сделать записи с этим тегом невосприимчивыми к автоматическому удалению. Защищенные записи никогда не удаляются автоматически независимо от возраста, глобальных настроек хранения или других периодов хранения тегов.

Используйте защиту для записей, которые должны быть постоянно сохранены:

- Юридические записи и записи соответствия требованиям
- Критические бизнес-решения
- Материалы обучения и адаптации
- Справочная документация
- Исторические архивы

Защита может быть удалена путем редактирования тега позже, если требования к сохранению изменятся. Удаление защиты не удаляет записи немедленно — они будут оценены для удаления при следующей проверке хранения на основе их возраста и других применимых политик хранения.

### Настройки автоматического обмена

Групповые теги поддерживают два уровня автоматического обмена, которые запускаются, когда любой участник группы применяет тег к записи:

**Share with All Group Members** — это подход по умолчанию и рекомендуемый. Когда включено, применение этого тега делится записью с каждым участником группы (исключая владельца). Все участники получают разрешения на просмотр и редактирование, обеспечивая полное сотрудничество.

**Share with Group Leads Only** ограничивает автоматический обмен администраторами групп. Когда включено, только пользователи с ролью администратора в этой группе получают автоматический доступ. Обычные участники не получают автоматический доступ, хотя администраторы групп могут вручную делиться с ними при необходимости. Эта опция подходит для чувствительного контента, который требует административного надзора перед более широким распространением.

Обе опции могут быть включены одновременно, хотя это избыточно — обмен со всеми участниками уже включает лидеров групп. Используйте одну или другую на основе чувствительности вашего контента и структуры группы.

### Управление групповыми тегами

Существующие групповые теги появляются в модальном окне групповых тегов с их текущими настройками. Нажмите значок редактирования, чтобы изменить имя тега, цвет, хранение, защиту или настройки обмена. Изменения влияют на тег в будущем, но не ретроактивно изменяют уже примененные теги или общие доступы.

Удаляйте групповые теги, нажав значок корзины. Удаленные теги:

- Удаляются со всех записей, к которым они были применены
- Исчезают из селекторов тегов для всех участников группы
- Не удаляют сами записи
- Не отзывают доступ, уже предоставленный через тег

Если тег широко использовался, рассмотрите влияние перед удалением. Пользователи могли организовать контент вокруг этого тега, и удаление удаляет эту организационную структуру. В большинстве случаев сохранение неиспользуемых тегов не причиняет вреда.

### Синхронизация групповых общих доступов

Если ваш экземпляр включил групповые функции после того, как записи уже были помечены, или если членство в группе значительно изменилось, у вас могут быть записи с групповыми тегами, которые не были автоматически общими с текущими участниками группы. Функция "Sync Group Shares" решает это.

Нажмите "Sync Group Shares" в модальном окне управления группой, чтобы открыть диалог синхронизации. Просмотрите информацию о том, что синхронизация будет делать — она применяет автоматический обмен ретроактивно ко всем существующим записям с тегами этой группы.

Операция синхронизации:

- Идентифицирует все записи, помеченные любым из тегов этой группы
- Проверяет каждую запись на наличие существующих общих доступов с текущими участниками группы
- Создает отсутствующие общие доступы для участников группы, которые должны иметь доступ, но не имеют
- Уважает настройки обмена тега (все участники против только лидеров групп)
- Пропускает записи, где участники уже имеют доступ

Подтвердите синхронизацию для выполнения. В зависимости от количества помеченных записей и размера группы это может занять от нескольких секунд до нескольких минут. Модальное окно результата показывает, сколько общих доступов было создано и сколько записей было обработано.

Синхронизация безопасна для запуска несколько раз — она не создаст дублирующие общие доступы. Используйте её после добавления многих новых участников, после исправления неправильно настроенных тегов или при миграции со старых версий Speakr, которые не имели полной поддержки групп.

## Роль администратора группы

Администраторы групп — это участники группы с повышенными разрешениями в области их группы. В отличие от полных администраторов экземпляра, которые могут управлять всеми группами и системными настройками, администраторы групп могут управлять только группами, где у них есть роль администратора.

### Предоставление доступа администратора группы

При добавлении участника в группу выберите "Admin" из выпадающего списка ролей. Пользователь немедленно получает возможности администратора группы только для этой группы. Они не могут управлять другими группами или получать доступ к административным функциям всей системы.

Администраторы групп видят ссылку "Group Management" в своем пользовательском меню вместо полной административной ссылки. Нажатие на это переносит их в сфокусированный административный интерфейс, показывающий только группы, которыми они управляют. Интерфейс идентичен вкладке Groups, которую видят обычные администраторы, но ограничен их группами.

### Возможности администратора группы

Администраторы групп могут выполнять эти действия в своих группах:

- Добавлять новых участников из пользовательской базы экземпляра
- Удалять существующих участников (исключая себя)
- Изменять роли участников между администратором и участником
- Создавать новые групповые теги с полными опциями конфигурации
- Редактировать существующие групповые теги, включая настройки хранения и обмена
- Удалять групповые теги
- Синхронизировать групповые общие доступы для своих групп

Администраторы групп не могут:

- Создавать новые группы
- Удалять группы
- Управлять группами, в которых они не являются администраторами
- Получать доступ к административным функциям всей системы (пользователи, настройки, статистика)
- Предоставлять себе административный доступ к другим группам

Этот ограниченный доступ позволяет вам распределять ответственность управления группами на лидеров групп без предоставления полного административного доступа. Лидеры групп могут управлять своими группами независимо, в то время как вы поддерживаете контроль над настройками всего экземпляра и созданием групп.

### Границы безопасности

Администраторы групп имеют мощные возможности в своих группах, но не могут повысить свои привилегии. Они не могут:

- Сделать себя полными администраторами экземпляра
- Предоставить себе административные роли в других группах
- Получать доступ или изменять системные настройки
- Просматривать статистику для других групп или всего экземпляра
- Удалять записи, принадлежащие другим пользователям (даже в их группе)

База данных обеспечивает эти границы на уровне API. Даже если администратор группы каким-то образом мог вызвать административные API всей системы, бэкенд проверяет разрешения и отклоняет неавторизованные запросы. UI просто скрывает элементы управления, которые администраторы групп не могут использовать, но безопасность не полагается на скрытие UI.

## Справочник конфигурации

### Переменные окружения

```bash
# Внутренний обмен (Обязательно)
ENABLE_INTERNAL_SHARING=true|false

# Отображение имени пользователя
SHOW_USERNAMES_IN_UI=true|false

# Контроль публичного обмена (Влияет на публичный обмен участников группы)
ENABLE_PUBLIC_SHARING=true|false

# Настройки хранения (Группы могут переопределить)
ENABLE_AUTO_DELETION=true|false
GLOBAL_RETENTION_DAYS=90
DELETION_MODE=audio_only|full_recording
```

### Схема базы данных

Группы используют несколько таблиц базы данных, которые работают вместе:

**Таблица Group**:
- `id`: Первичный ключ
- `name`: Имя группы (макс. 100 символов)
- `description`: Необязательное описание группы
- `created_by`: ID пользователя создателя (полный администратор)
- `created_at`: Временная метка создания

**Таблица TeamMembership**:
- `id`: Первичный ключ
- `team_id`: Ссылается на Group
- `user_id`: Ссылается на User
- `role`: "admin" или "member"
- `joined_at`: Временная метка членства

**Таблица Tag** (Расширенная):
- `team_id`: Ссылается на Group (null для личных тегов)
- `retention_days`: Пользовательское переопределение хранения (null использует глобальное)
- `protect_from_deletion`: Булевый флаг защиты
- `auto_share_on_apply`: Булево (делиться со всеми участниками)
- `share_with_team_lead`: Булево (делиться только с администраторами групп)

Каскадное удаление настроено так, что удаление группы удаляет её теги и членства, но сохраняет записи и общие доступы.

## Решение проблем

### Вкладка Groups не видна

**Причина**: Внутренний обмен не включен или настроен неправильно.

**Решение**:
1. Проверьте, что `.env` содержит `ENABLE_INTERNAL_SHARING=true`
2. Перезапустите Speakr после изменений `.env`
3. Очистите кеш браузера и перезагрузите
4. Проверьте логи приложения на ошибки запуска

### Пользователи не видят групповые теги

**Причина**: Пользователь не добавлен в группу или внутренний обмен отключен.

**Решение**:
1. Проверьте, что пользователь перечислен в членстве группы
2. Подтвердите `ENABLE_INTERNAL_SHARING=true` в `.env`
3. Проверьте, что пользователь вошел в систему (групповые теги скрыты для анонимных пользователей)
4. Обновите страницу, чтобы загрузить обновленные списки тегов

### Автоматический обмен не работает

**Причина**: Групповой тег неправильно настроен или внутренний обмен отключен.

**Решение**:
1. Отредактируйте групповой тег и проверьте, что "Share with all group members" или "Share with group leads" включено
2. Подтвердите `ENABLE_INTERNAL_SHARING=true` в `.env`
3. Проверьте логи приложения при применении тегов на ошибки обмена
4. Попробуйте вручную поделиться записью, чтобы проверить, работает ли инфраструктура обмена

### Администратор группы не может получить доступ к административному интерфейсу

**Причина**: Пользователь не имеет роли администратора ни в одной группе или проблема с маршрутизацией.

**Решение**:
1. Проверьте, что роль пользователя "admin", а не "member" в членстве группы
2. Попросите пользователя выйти и войти снова, чтобы обновить сессию
3. Проверьте, что ссылка "Group Management" появляется в пользовательском меню (не "Admin")
4. Просмотрите логи приложения на ошибки разрешений

### Записи не удаляются согласно политике хранения

**Причина**: Защищенные теги, неправильно настроенное хранение или автоматическое удаление отключено.

**Решение**:
1. Проверьте, имеет ли запись защищенные групповые теги
2. Проверьте `ENABLE_AUTO_DELETION=true` в `.env`
3. Подтвердите, что `GLOBAL_RETENTION_DAYS` установлен, если не применяется хранение тегов
4. Просмотрите логи планировщика cron на ошибки удаления
5. Проверьте, что `retention_days` тега установлен правильно (null = использовать глобальное)

### Sync Group Shares показывает ноль созданных общих доступов

**Причина**: Все применимые общие доступы уже существуют, или нет записей с групповыми тегами.

**Решение**:
1. Проверьте, что записи фактически имеют теги из этой группы
2. Проверьте, имеют ли участники группы уже доступ через другие общие доступы
3. Просмотрите, принадлежат ли записи текущим участникам группы (нет самообмена)
4. Подтвердите, что группа имеет участников помимо владельцев записей

## Лучшие практики

### Структура группы

**Малые организации (<10 пользователей)**:
Создавайте группы по отделам (Engineering, Sales, HR). Используйте групповые теги для названий проектов или типов контента. Либеральное использование групп способствует сотрудничеству, поскольку все знают друг друга.

**Крупные организации (>10 пользователей)**:
Создавайте группы по продуктам, подразделениям или крупным проектам. Используйте вложенные организационные паттерны при необходимости (отдельные группы для Product A Engineering и Product A Sales). Более избирательное членство в группе предотвращает информационную перегрузку.

### Соглашения об именовании тегов

Установите соглашения рано и документируйте их для согласованности:

```
На основе проекта: "Project-Phoenix", "Initiative-Q3-2024"
Тип контента: "Sprint-Reviews", "Customer-Calls", "Legal-Contracts"
Отдел: "Eng-Architecture", "Sales-Training", "HR-Interviews"
```

Избегайте общих имен, которые не передают цель:
❌ "Important", "Misc", "Other", "Temp", "Group"
✓ "Executive-Briefings", "Tech-Specs", "Client-Demos"

### Стратегия хранения

Установите продуманные значения по умолчанию, которые балансируют затраты на хранилище с потребностями соответствия требованиям:

```
Глобальное по умолчанию: 90 дней (захватывает большинство контента)
Теги юридической группы: 2555 дней (7 лет для юридических записей)
Теги соответствия: Защищенные (постоянное хранение)
Теги встреч: 180 дней (разумное окно сотрудничества)
Теги стендапов: 14 дней (эфемерный ежедневный контент)
```

Просматривайте политики хранения ежеквартально, чтобы убедиться, что они остаются подходящими по мере изменения бизнес-потребностей.

### Распределение администраторов групп

Предоставляйте роли администраторов групп естественным лидерам групп — менеджерам проектов, руководителям отделов, техническим лидерам. Это распределяет административную рабочую нагрузку и расширяет возможности групп для самоуправления.

Избегайте слишком либерального предоставления администратора группы. Хотя это ограничено отдельными группами, администраторы групп могут добавлять участников и создавать теги, которые влияют на доступ. Ограничьте роль доверенными людьми, которые понимают последствия безопасности.

Документируйте администраторов каждой группы в описании группы или внешней документации. Будущие администраторы оценят знание, к кому обращаться по вопросам, специфичным для группы.

## Интеграция с другими функциями

### Режим Inquire

Групповые теги автоматически появляются в доступных фильтрах режима Inquire, обеспечивая семантический поиск в области группы. Пользователи могут искать "обсуждения бюджета" и фильтровать только свою проектную группу, находя релевантные беседы без шума от других групп.

Записи, которыми поделились через групповые теги, включаются в результаты семантического поиска. Векторное хранилище индексирует все доступные записи, что означает, что групповой контент автоматически становится частью доступной для поиска базы знаний пользователей.

### Хранение и автоматическое удаление

Политики хранения на уровне тегов интегрируются с системой автоматического удаления Speakr. Ежедневная проверка хранения оценивает теги каждой записи, чтобы определить применимые периоды хранения:

1. Если запись имеет защищенные теги → Никогда не удаляется
2. Если запись имеет теги с `retention_days` → Используйте самый короткий период хранения тега
3. Иначе → Используйте глобальный `GLOBAL_RETENTION_DAYS`

Эта каскадная система позволяет группам устанавливать конкретные политики, поддерживая при этом значения по умолчанию для всего экземпляра для непомеченного контента.

### Публичный обмен

Членство в группе не влияет на возможности публичного обмена. Способность пользователей создавать публичные ссылки для обмена контролируется:

1. Глобальной настройкой `ENABLE_PUBLIC_SHARING`
2. Разрешением `can_share_publicly` для каждого пользователя (если глобальное включено)

Участники группы могут создавать публичные ссылки для групповых записей, если у них есть соответствующие разрешения, обеспечивая общение с внешними заинтересованными сторонами, поддерживая при этом сотрудничество внутри группы.

---

Группы преобразуют многопользовательские экземпляры Speakr в совместные платформы, где информация автоматически течет к релевантным людям. Правильная конфигурация и управление обеспечивают безопасность, обеспечивая при этом бесшовный обмен знаниями.

Для пользовательской документации по группам см. руководство [Сотрудничество в группах](../user-guide/groups.md).

Вернуться к [Руководству администратора](index.md) →
